!function(n){"use strict";function e(n,e){var t=function(n){return n.split(".").reduce(function(n,e){return n.concat(n.length?n[n.length-1]+"."+e:e)},[])},r=void 0,o=e?t(e.name):[],i=t(n.name),u=Math.min(o.length,i.length);if(e&&e.name===n.name)r=Math.max(u-1,0);else for(r=0;u>r&&o[r]===i[r];r+=1);var c=o.slice(r).reverse(),a=e&&r>0?o[r-1]:"";return{toDeactivate:c,intersection:a}}function t(){function n(n){var e=function(e,t,r){var o=e.replace(/^(\*|\^|=)/,"");if(o&&!/^\$/.test(e)){var i=n.rootNode.getSegmentsByName(o);i||console.warn("No route found for "+o+", listener might never be called!")}return u[e]||(u[e]=[]),u[e]=(r?[]:u[e]).concat(t),n};n.addListener=function(n){return e("*",n)},n.removeListener=function(n){return c("*",n)},n.addNodeListener=function(n,t){return e("^"+n,t,!0)},n.removeNodeListener=function(n,e){return c("^"+n,e)},n.addRouteListener=function(n,t){return e("="+n,t)},n.removeRouteListener=function(n,e){return c("="+n,e)}}function t(n,e,t){(u[n]||[]).forEach(function(n){return n(e,t)})}function o(n,r,o){var i=e(n,r),u=i.intersection,a=i.toDeactivate,f=(o.reload?"":u,n.name);router.options.autoCleanUp&&a.forEach(function(n){return c("^"+n)}),t("^"+u,n,r),t("="+f,n,r),t("*",n,r)}function i(){u={}}var u={},c=function(n,e){return e?u[n]&&(u[n]=u[n].filter(function(n){return n!==e})):u[n]=[],router};return{name:r,init:n,onTransitionSuccess:o,flush:i,listeners:u}}var r="LISTENERS";n.router5ListenersPlugin=t}(window);