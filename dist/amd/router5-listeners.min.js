define("router5ListenersPlugin",[],function(){"use strict";function n(n,e){function t(n){return n.split(".").reduce(function(n,e){return n.concat(n.length?n[n.length-1]+"."+e:e)},[])}var r=void 0,o=e?t(e.name):[],i=t(n.name),u=Math.min(o.length,i.length);if(e&&e.name===n.name)r=Math.max(u-1,0);else for(r=0;u>r&&o[r]===i[r];r+=1);var c=o.slice(r).reverse(),a=i.slice(r),f=e&&r>0?o[r-1]:"";return{intersection:f,toDeactivate:c,toActivate:a}}function e(){function e(n){c=n;var e=function(n,e,t){var r=n.replace(/^(\*|\^|=)/,"");if(r&&!/^\$/.test(n)){var o=c.rootNode.getSegmentsByName(r);o||console.warn("No route found for "+r+", listener might never be called!")}return u[n]||(u[n]=[]),u[n]=(t?[]:u[n]).concat(e),c};c.addListener=function(n){return e("*",n)},c.removeListener=function(n){return a("*",n)},c.addNodeListener=function(n,t){return e("^"+n,t,!0)},c.removeNodeListener=function(n,e){return a("^"+n,e)},c.addRouteListener=function(n,t){return e("="+n,t)},c.removeRouteListener=function(n,e){return a("="+n,e)}}function r(n,e,t){(u[n]||[]).forEach(function(n){return n(e,t)})}function o(e,t,o){var i=n(e,t),u=i.intersection,f=i.toDeactivate,s=(o.reload?"":u,e.name);c.options.autoCleanUp&&f.forEach(function(n){return a("^"+n)}),r("^"+u,e,t),r("="+s,e,t),r("*",e,t)}function i(){u={}}var u={},c=void 0,a=function(n,e){return e?u[n]&&(u[n]=u[n].filter(function(n){return n!==e})):u[n]=[],c};return{name:t,init:e,onTransitionSuccess:o,flush:i,listeners:u}}var t="LISTENERS";return e});